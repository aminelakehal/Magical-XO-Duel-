<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Magical XO Duel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        @keyframes sparkle {
            0% { opacity: 0; transform: scale(0); }
            50% { opacity: 1; transform: scale(1.5); }
            100% { opacity: 0; transform: scale(0); }
        }
        .pulse {
            animation: pulse 2s infinite;
        }
        .float {
            animation: float 3s ease-in-out infinite;
        }
        .sparkle {
            position: absolute;
            width: 10px;
            height: 10px;
            background: gold;
            border-radius: 50%;
            pointer-events: none;
            animation: sparkle 1s forwards;
        }
        .cell {
            transition: all 0.3s ease;
        }
        .cell:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.5);
        }
        .magic-circle {
            position: absolute;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 2px dashed rgba(255, 215, 0, 0.7);
            pointer-events: none;
        }
        .x-symbol {
            color: #FF5733;
            text-shadow: 0 0 10px #FF5733;
        }
        .o-symbol {
            color: #33A1FF;
            text-shadow: 0 0 10px #33A1FF;
        }
        .win-line {
            position: absolute;
            background: linear-gradient(90deg, rgba(255,215,0,0), gold, rgba(255,215,0,0));
            z-index: 10;
        }
    </style>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center justify-center p-4">
    <div class="absolute top-0 left-0 w-full h-full overflow-hidden pointer-events-none">
        <div id="stars-container"></div>
    </div>

    <div class="text-center mb-8">
        <h1 class="text-5xl font-bold mb-2 text-transparent bg-clip-text bg-gradient-to-r from-purple-400 to-pink-600">
            <i class="fas fa-hat-wizard mr-2 float"></i>
            Magical XO Duel
            <i class="fas fa-wand-sparkles ml-2 float" style="animation-delay: 0.5s"></i>
        </h1>
        <p class="text-xl text-purple-200">A battle of arcane symbols!</p>
    </div>

    <div class="relative">
        <div class="absolute -inset-4 rounded-lg bg-gradient-to-r from-purple-600 to-blue-500 opacity-75 blur-lg"></div>
        <div class="relative bg-gray-800 rounded-lg p-6 shadow-2xl border border-purple-500">
            <div class="flex justify-between items-center mb-6">
                <div id="player-x" class="flex items-center px-4 py-2 rounded-lg bg-gray-700 border border-red-400">
                    <i class="fas fa-fire text-2xl mr-2 text-red-400"></i>
                    <span class="font-bold">Wizard X</span>
                    <span id="score-x" class="ml-2 px-2 bg-red-900 rounded">0</span>
                </div>
                <div id="current-turn" class="px-4 py-2 rounded-lg bg-purple-900 font-bold pulse">
                    <i class="fas fa-fire mr-1 text-red-400"></i> X's Turn
                </div>
                <div id="player-o" class="flex items-center px-4 py-2 rounded-lg bg-gray-700 border border-blue-400">
                    <i class="fas fa-snowflake text-2xl mr-2 text-blue-400"></i>
                    <span class="font-bold">Sorceress O</span>
                    <span id="score-o" class="ml-2 px-2 bg-blue-900 rounded">0</span>
                </div>
            </div>

            <div class="grid grid-cols-3 gap-3 mb-6 relative" id="game-board">
                <!-- Cells will be generated by JavaScript -->
            </div>

            <div class="flex justify-between">
                <button id="reset-btn" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 rounded-lg font-bold transition-all">
                    <i class="fas fa-redo mr-2"></i>Reset Board
                </button>
                <button id="new-game-btn" class="px-4 py-2 bg-pink-600 hover:bg-pink-700 rounded-lg font-bold transition-all">
                    <i class="fas fa-star mr-2"></i>New Game
                </button>
            </div>
        </div>
    </div>

    <div class="mt-8 text-center text-gray-400">
        <p>Cast your symbol wisely! The first to align three wins the duel.</p>
    </div>

    <audio id="click-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-arcade-game-jump-coin-216.mp3"></audio>
    <audio id="win-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3"></audio>
    <audio id="draw-sound" src="https://assets.mixkit.co/sfx/preview/mixkit-retro-arcade-game-over-470.mp3"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Game state
            let board = ['', '', '', '', '', '', '', '', ''];
            let currentPlayer = 'X';
            let gameActive = true;
            let scores = { X: 0, O: 0 };
            let winLine = null;

            // DOM elements
            const gameBoard = document.getElementById('game-board');
            const currentTurnDisplay = document.getElementById('current-turn');
            const scoreX = document.getElementById('score-x');
            const scoreO = document.getElementById('score-o');
            const resetBtn = document.getElementById('reset-btn');
            const newGameBtn = document.getElementById('new-game-btn');
            const clickSound = document.getElementById('click-sound');
            const winSound = document.getElementById('win-sound');
            const drawSound = document.getElementById('draw-sound');
            const starsContainer = document.getElementById('stars-container');

            // Create stars for background
            function createStars() {
                for (let i = 0; i < 50; i++) {
                    const star = document.createElement('div');
                    star.className = 'absolute w-1 h-1 bg-white rounded-full';
                    star.style.left = `${Math.random() * 100}%`;
                    star.style.top = `${Math.random() * 100}%`;
                    star.style.opacity = Math.random();
                    star.style.animation = `float ${3 + Math.random() * 5}s ease-in-out infinite`;
                    star.style.animationDelay = `${Math.random() * 5}s`;
                    starsContainer.appendChild(star);
                }
            }

            // Create game board cells
            function createBoard() {
                gameBoard.innerHTML = '';
                for (let i = 0; i < 9; i++) {
                    const cell = document.createElement('div');
                    cell.className = 'cell w-24 h-24 bg-gray-700 rounded-lg flex items-center justify-center text-5xl font-bold cursor-pointer relative overflow-hidden';
                    cell.dataset.index = i;
                    cell.addEventListener('click', () => handleCellClick(i));
                    gameBoard.appendChild(cell);
                }
            }

            // Handle cell click
            function handleCellClick(index) {
                if (!gameActive || board[index] !== '') return;

                // Play sound
                clickSound.currentTime = 0;
                clickSound.play();

                // Update board
                board[index] = currentPlayer;
                renderBoard();

                // Check for winner or draw
                const winner = checkWinner();
                if (winner) {
                    handleWin(winner);
                } else if (isBoardFull()) {
                    handleDraw();
                } else {
                    // Switch player
                    currentPlayer = currentPlayer === 'X' ? 'O' : 'X';
                    updateTurnDisplay();
                }
            }

            // Render board
            function renderBoard() {
                const cells = document.querySelectorAll('.cell');
                cells.forEach((cell, index) => {
                    cell.innerHTML = '';
                    
                    if (board[index] === 'X') {
                        const xSymbol = document.createElement('i');
                        xSymbol.className = 'fas fa-fire x-symbol text-6xl';
                        cell.appendChild(xSymbol);
                        
                        // Add magic circle
                        const circle = document.createElement('div');
                        circle.className = 'magic-circle';
                        cell.appendChild(circle);
                        
                        // Add sparkles
                        addSparkles(cell);
                    } else if (board[index] === 'O') {
                        const oSymbol = document.createElement('i');
                        oSymbol.className = 'fas fa-snowflake o-symbol text-6xl';
                        cell.appendChild(oSymbol);
                        
                        // Add magic circle
                        const circle = document.createElement('div');
                        circle.className = 'magic-circle';
                        cell.appendChild(circle);
                        
                        // Add sparkles
                        addSparkles(cell);
                    }
                });
            }

            // Add sparkle effects
            function addSparkles(element) {
                for (let i = 0; i < 5; i++) {
                    setTimeout(() => {
                        const sparkle = document.createElement('div');
                        sparkle.className = 'sparkle';
                        sparkle.style.left = `${10 + Math.random() * 80}%`;
                        sparkle.style.top = `${10 + Math.random() * 80}%`;
                        sparkle.style.animationDelay = `${i * 0.2}s`;
                        element.appendChild(sparkle);
                        
                        // Remove sparkle after animation
                        setTimeout(() => {
                            sparkle.remove();
                        }, 1000);
                    }, i * 200);
                }
            }

            // Check for winner
            function checkWinner() {
                const winningCombinations = [
                [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
                [0, 3, 6], [1, 4, 7], [2, 5, 8], // columns
                [0, 4, 8], [2, 4, 6]             // diagonals
                ];

                for (const combo of winningCombinations) {
                    const [a, b, c] = combo;
                    if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                        return board[a];
                    }
                }
                return null;
            }

            // Check if board is full
            function isBoardFull() {
                return board.every(cell => cell !== '');
            }

            // Handle win
            function handleWin(winner) {
                gameActive = false;
                scores[winner]++;
                updateScores();
                
                // Play win sound
                winSound.play();
                
                // Highlight winning cells
                highlightWinningCells();
                
                // Update turn display
                currentTurnDisplay.innerHTML = `<i class="fas fa-trophy mr-1 text-yellow-400"></i> ${winner} Wins!`;
                currentTurnDisplay.className = 'px-4 py-2 rounded-lg bg-yellow-900 font-bold pulse';
            }

            // Handle draw
            function handleDraw() {
                gameActive = false;
                
                // Play draw sound
                drawSound.play();
                
                // Update turn display
                currentTurnDisplay.innerHTML = '<i class="fas fa-handshake mr-1 text-gray-300"></i> Draw!';
                currentTurnDisplay.className = 'px-4 py-2 rounded-lg bg-gray-600 font-bold';
            }

            // Highlight winning cells
            function highlightWinningCells() {
                const winningCombinations = [
                    [0, 1, 2], [3, 4, 5], [6, 7, 8], // rows
                    [0, 3, 6], [1, 4, 7], [2, 5, 8], // columns
                    [0, 4, 8], [2, 4, 6]             // diagonals
                ];

                // Find the winning combination
                let winningCombo = null;
                for (const combo of winningCombinations) {
                    const [a, b, c] = combo;
                    if (board[a] && board[a] === board[b] && board[a] === board[c]) {
                        winningCombo = combo;
                        break;
                    }
                }

                if (!winningCombo) return;

                // Remove any existing win line
                if (winLine) {
                    winLine.remove();
                }

                // Get the cells
                const cells = document.querySelectorAll('.cell');
                const firstCell = cells[winningCombo[0]];
                const lastCell = cells[winningCombo[2]];

                // Calculate positions for the win line
                const firstRect = firstCell.getBoundingClientRect();
                const lastRect = lastCell.getBoundingClientRect();
                const boardRect = gameBoard.getBoundingClientRect();

                // Create win line
                winLine = document.createElement('div');
                winLine.className = 'win-line';

                // Horizontal line
                if (winningCombo[0] <= 2 && winningCombo[2] <= 2 || 
                    winningCombo[0] >= 3 && winningCombo[0] <= 5 && winningCombo[2] >= 3 && winningCombo[2] <= 5 || 
                    winningCombo[0] >= 6) {
                    winLine.style.width = `${lastRect.right - firstRect.left}px`;
                    winLine.style.height = '4px';
                    winLine.style.top = `${firstRect.top + firstRect.height / 2 - boardRect.top}px`;
                    winLine.style.left = `${firstRect.left - boardRect.left}px`;
                } 
                // Vertical line
                else if (winningCombo[0] % 3 === 0 && winningCombo[2] % 3 === 0) {
                    winLine.style.width = '4px';
                    winLine.style.height = `${lastRect.bottom - firstRect.top}px`;
                    winLine.style.left = `${firstRect.left + firstRect.width / 2 - boardRect.left}px`;
                    winLine.style.top = `${firstRect.top - boardRect.top}px`;
                } 
                // Diagonal (top-left to bottom-right)
                else if (winningCombo[0] === 0 && winningCombo[2] === 8) {
                    winLine.style.width = `${Math.sqrt(Math.pow(lastRect.right - firstRect.left, 2) + Math.pow(lastRect.bottom - firstRect.top, 2))}px`;
                    winLine.style.height = '4px';
                    winLine.style.top = `${firstRect.top + firstRect.height / 2 - boardRect.top}px`;
                    winLine.style.left = `${firstRect.left - boardRect.left}px`;
                    winLine.style.transformOrigin = '0 0';
                    winLine.style.transform = 'rotate(45deg)';
                } 
                // Diagonal (top-right to bottom-left)
                else if (winningCombo[0] === 2 && winningCombo[2] === 6) {
                    winLine.style.width = `${Math.sqrt(Math.pow(firstRect.left - lastRect.right, 2) + Math.pow(lastRect.bottom - firstRect.top, 2))}px`;
                    winLine.style.height = '4px';
                    winLine.style.top = `${firstRect.top + firstRect.height / 2 - boardRect.top}px`;
                    winLine.style.left = `${firstRect.left + firstRect.width - boardRect.left}px`;
                    winLine.style.transformOrigin = '0 0';
                    winLine.style.transform = 'rotate(-45deg)';
                }

                gameBoard.appendChild(winLine);
            }

            // Update scores display
            function updateScores() {
                scoreX.textContent = scores.X;
                scoreO.textContent = scores.O;
            }

            // Update turn display
            function updateTurnDisplay() {
                if (currentPlayer === 'X') {
                    currentTurnDisplay.innerHTML = '<i class="fas fa-fire mr-1 text-red-400"></i> X\'s Turn';
                    currentTurnDisplay.className = 'px-4 py-2 rounded-lg bg-red-900 font-bold pulse';
                } else {
                    currentTurnDisplay.innerHTML = '<i class="fas fa-snowflake mr-1 text-blue-400"></i> O\'s Turn';
                    currentTurnDisplay.className = 'px-4 py-2 rounded-lg bg-blue-900 font-bold pulse';
                }
            }

            // Reset board
            function resetBoard() {
                board = ['', '', '', '', '', '', '', '', ''];
                currentPlayer = 'X';
                gameActive = true;
                
                if (winLine) {
                    winLine.remove();
                    winLine = null;
                }
                
                renderBoard();
                updateTurnDisplay();
            }

            // New game (reset scores)
            function newGame() {
                scores = { X: 0, O: 0 };
                updateScores();
                resetBoard();
            }

            // Event listeners
            resetBtn.addEventListener('click', resetBoard);
            newGameBtn.addEventListener('click', newGame);

            // Initialize game
            createStars();
            createBoard();
            updateTurnDisplay();
        });
    </script>
</body>
</html>